{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\Alfredo\\\\Desktop\\\\front-end utils\\\\progetti\\\\SiciliaNaturalmenteApp\\\\screens\\\\CartScreen.js\";\n\nimport React, { useEffect, useState } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { Header, Button, Overlay, Text } from 'react-native-elements';\nimport { FlatList } from 'react-native-gesture-handler';\nimport { AntDesign } from '@expo/vector-icons';\nimport * as cartActions from \"../store/actions/cart\";\nimport { useSelector, useDispatch } from 'react-redux';\nimport { StatusBar } from 'expo-status-bar';\nimport CustomModal from \"../components/CustomModal\";\nimport CartProduct from \"../components/cartProduct\";\nimport { images } from \"../data/dummy-data\";\nimport { useStripe } from '@stripe/stripe-react-native';\nimport axios from 'axios';\nimport UserLoggedOption from \"../components/userLoggedComponent/userLoggedOption\";\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\nimport { Divider } from 'react-native-elements/dist/divider/Divider';\n\nvar createAlert = function createAlert(navigation) {\n  return Alert.alert('Checkout forbidden', 'Devi autenticarti per continuare!', [{\n    text: 'OK',\n    onPress: function onPress() {\n      return navigation.navigate('Account');\n    },\n    style: 'cancel'\n  }]);\n};\n\nvar CartScreen = function CartScreen(_ref) {\n  var navigation = _ref.navigation;\n\n  var _useStripe = useStripe(),\n      initPaymentSheet = _useStripe.initPaymentSheet,\n      presentPaymentSheet = _useStripe.presentPaymentSheet,\n      createToken = _useStripe.createToken;\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      clientSecret = _useState2[0],\n      setClientSecret = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      paymentChoice = _useState4[0],\n      setPaymentChoice = _useState4[1];\n\n  var cartItems = useSelector(function (state) {\n    console.log(state.cart.items);\n    var transformedCartItems = [];\n\n    for (var key in state.cart.items) {\n      transformedCartItems.push({\n        productId: key,\n        productTitle: state.cart.items[key].productTitle,\n        productPrice: state.cart.items[key].productPrice,\n        productImage: state.cart.items[key].productImage,\n        quantity: state.cart.items[key].quantity\n      });\n    }\n\n    return transformedCartItems;\n  });\n  var cartTotalAmount = useSelector(function (state) {\n    return state.cart.totalAmount;\n  });\n  var isAuth = useSelector(function (state) {\n    return state.user.isAuthenticated;\n  });\n  var checkoutSuccess = useSelector(function (state) {\n    return state.cart.checkoutSuccess;\n  });\n  var emailUser = useSelector(function (state) {\n    return state.user;\n  });\n  var dispatch = useDispatch();\n\n  var checkout = function checkout(method) {\n    if (!isAuth) {\n      return createAlert(navigation);\n    }\n\n    if (method === 'contanti') {\n      dispatch(cartActions.checkout(cartItems, emailUser, cartTotalAmount));\n    }\n\n    setPaymentChoice(false);\n  };\n\n  return React.createElement(SafeAreaView, {\n    style: styles.screen,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 5\n    }\n  }, React.createElement(Header, {\n    backgroundImage: images.otherImages.cartBackgroundHeader,\n    backgroundImageStyle: {\n      borderRadius: 30\n    },\n    statusBarProps: {\n      barStyle: 'light-content'\n    },\n    backgroundColor: \"#F6F7FA\",\n    rightContainerStyle: {\n      alignSelf: 'center'\n    },\n    containerStyle: {\n      height: 120\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }\n  }), React.createElement(FlatList, {\n    style: styles.container,\n    ListHeaderComponent: React.createElement(Text, {\n      style: {\n        fontSize: 23,\n        fontFamily: 'Inter_600SemiBold',\n        color: '#094067',\n        marginBottom: 20\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 11\n      }\n    }, \"I tuoi ordini\"),\n    data: cartItems,\n    keyExtractor: function keyExtractor(item) {\n      return item.productId;\n    },\n    renderItem: function renderItem(itemData) {\n      return React.createElement(CartProduct, {\n        image: itemData.item.productImage,\n        title: itemData.item.productTitle,\n        quantity: itemData.item.quantity,\n        product: itemData.item,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 11\n        }\n      });\n    },\n    ListFooterComponent: React.createElement(React.Fragment, null, React.createElement(View, {\n      style: styles.priceContainer,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 13\n      }\n    }, cartTotalAmount === 0 ? React.createElement(Text, {\n      style: {\n        fontFamily: 'Inter_400Regular',\n        textAlign: 'center',\n        color: '#5f6c7b'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 17\n      }\n    }, \"Il tuo carrello \\xE8 vuoto torna ad aggiungere dei prodotti!\") : React.createElement(Text, {\n      style: styles.summaryText,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 17\n      }\n    }, \"Total: \", React.createElement(Text, {\n      style: styles.amount,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 26\n      }\n    }, \"\\u20AC\", cartTotalAmount))), React.createElement(View, {\n      style: {\n        marginTop: 30,\n        width: '100%',\n        overflow: 'hidden'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 13\n      }\n    }, React.createElement(Button, {\n      onPress: function onPress() {\n        return setPaymentChoice(true);\n      },\n      title: \"acquista!\",\n      disabled: cartTotalAmount === 0,\n      raised: true,\n      icon: React.createElement(AntDesign, {\n        name: \"checkcircleo\",\n        size: 24,\n        color: \"white\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 23\n        }\n      }),\n      iconRight: true,\n      titleStyle: {\n        fontFamily: 'Inter_400Regular'\n      },\n      containerStyle: {\n        width: '95%',\n        alignSelf: 'center'\n      },\n      buttonStyle: {\n        backgroundColor: '#3da9fc',\n        justifyContent: 'space-between',\n        padding: 15\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 15\n      }\n    }))),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }\n  }), React.createElement(Overlay, {\n    isVisible: paymentChoice,\n    overlayStyle: {\n      width: '80%'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    h4: true,\n    style: {\n      textAlign: 'center',\n      marginBottom: 10\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 9\n    }\n  }, \"Scelgi il metodo di pagamento\"), React.createElement(Divider, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 9\n    }\n  }), React.createElement(UserLoggedOption, {\n    customStyle: {\n      backgroundColor: '#d8eefe',\n      padding: 5,\n      marginTop: 30,\n      color: '#020826'\n    },\n    customHandler: function customHandler() {\n      return checkout('contanti');\n    },\n    customColor: \"#094067\",\n    title: \"Paga in contanti\",\n    icon: React.createElement(MaterialCommunityIcons, {\n      name: \"cash-marker\",\n      size: 24,\n      color: \"#3da9fc\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 13\n      }\n    }),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 9\n    }\n  }), React.createElement(UserLoggedOption, {\n    customStyle: {\n      backgroundColor: '#d8eefe',\n      padding: 5\n    },\n    customHandler: function customHandler() {\n      return checkout('carta');\n    },\n    customColor: \"#094067\",\n    title: \"Paga con carta\",\n    icon: React.createElement(MaterialCommunityIcons, {\n      name: \"credit-card-check-outline\",\n      size: 24,\n      color: \"#3da9fc\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 13\n      }\n    }),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 9\n    }\n  }), React.createElement(UserLoggedOption, {\n    customStyle: {\n      backgroundColor: '#d8eefe',\n      padding: 5\n    },\n    customHandler: function customHandler() {\n      return setPaymentChoice(false);\n    },\n    customColor: \"#094067\",\n    title: \"Annulla\",\n    icon: React.createElement(MaterialCommunityIcons, {\n      name: \"window-close\",\n      size: 24,\n      color: \"#ef4565\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 13\n      }\n    }),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 9\n    }\n  })), React.createElement(CustomModal, {\n    showModal: checkoutSuccess,\n    text: \"Checkout Effettuato\",\n    theme: \"rgba(66, 135, 245, 1)\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 7\n    }\n  }), React.createElement(StatusBar, {\n    style: \"light\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 7\n    }\n  }));\n};\n\nvar styles = StyleSheet.create({\n  screen: {\n    flex: 1,\n    backgroundColor: '#F6F7FA'\n  },\n  container: {\n    marginVertical: 20,\n    width: '85%',\n    alignSelf: 'center'\n  },\n  product: {\n    flexDirection: 'row',\n    width: '100%',\n    marginTop: 15\n  },\n  priceContainer: {\n    alignItems: 'flex-end',\n    marginBottom: 30\n  },\n  amount: {\n    fontSize: 20,\n    fontFamily: 'Inter_600SemiBold',\n    color: '#094067'\n  },\n  summaryText: {\n    marginTop: 10,\n    marginRight: 10\n  },\n  text: {\n    textAlign: 'center',\n    fontFamily: 'Inter_400Regular',\n    marginVertical: 3\n  }\n});\nexport default CartScreen;","map":{"version":3,"sources":["C:/Users/Alfredo/Desktop/front-end utils/progetti/SiciliaNaturalmenteApp/screens/CartScreen.js"],"names":["React","useEffect","useState","Header","Button","Overlay","Text","FlatList","AntDesign","cartActions","useSelector","useDispatch","StatusBar","CustomModal","CartProduct","images","useStripe","axios","UserLoggedOption","MaterialCommunityIcons","Divider","createAlert","navigation","Alert","alert","text","onPress","navigate","style","CartScreen","initPaymentSheet","presentPaymentSheet","createToken","clientSecret","setClientSecret","paymentChoice","setPaymentChoice","cartItems","state","console","log","cart","items","transformedCartItems","key","push","productId","productTitle","productPrice","productImage","quantity","cartTotalAmount","totalAmount","isAuth","user","isAuthenticated","checkoutSuccess","emailUser","dispatch","checkout","method","styles","screen","otherImages","cartBackgroundHeader","borderRadius","barStyle","alignSelf","height","container","fontSize","fontFamily","color","marginBottom","item","itemData","priceContainer","textAlign","summaryText","amount","marginTop","width","overflow","backgroundColor","justifyContent","padding","StyleSheet","create","flex","marginVertical","product","flexDirection","alignItems","marginRight"],"mappings":"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","sourcesContent":["// * CART SCREEN\r\n// ? what can you do\r\n// * checkout method when user is authenticated\r\n// * add and delete product from the cart\r\n\r\nimport React, { useEffect, useState } from 'react'\r\nimport { View, StyleSheet, SafeAreaView, Image, Alert } from 'react-native'\r\nimport { Header, Button, Overlay, Text } from 'react-native-elements'\r\nimport { FlatList } from 'react-native-gesture-handler'\r\nimport { AntDesign } from '@expo/vector-icons'\r\nimport * as cartActions from '../store/actions/cart'\r\nimport { useSelector, useDispatch } from 'react-redux'\r\nimport { StatusBar } from 'expo-status-bar'\r\nimport CustomModal from '../components/CustomModal'\r\nimport CartProduct from '../components/cartProduct'\r\nimport { images } from '../data/dummy-data'\r\nimport { useStripe } from '@stripe/stripe-react-native'\r\nimport axios from 'axios'\r\nimport UserLoggedOption from '../components/userLoggedComponent/userLoggedOption'\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons'\r\nimport { Divider } from 'react-native-elements/dist/divider/Divider'\r\n\r\nconst createAlert = (navigation) =>\r\n  Alert.alert('Checkout forbidden', 'Devi autenticarti per continuare!', [\r\n    {\r\n      text: 'OK',\r\n      onPress: () => navigation.navigate('Account'),\r\n      style: 'cancel',\r\n    },\r\n  ])\r\n\r\nconst CartScreen = ({ navigation }) => {\r\n  /* start Stripe logic */\r\n  const { initPaymentSheet, presentPaymentSheet, createToken } = useStripe()\r\n\r\n  //integrate payment sheet Stripe\r\n\r\n  const [clientSecret, setClientSecret] = useState('')\r\n  const [paymentChoice, setPaymentChoice] = useState(false)\r\n\r\n  const cartItems = useSelector((state) => {\r\n    console.log(state.cart.items)\r\n\r\n    const transformedCartItems = []\r\n    for (const key in state.cart.items) {\r\n      transformedCartItems.push({\r\n        productId: key,\r\n        productTitle: state.cart.items[key].productTitle,\r\n        productPrice: state.cart.items[key].productPrice,\r\n        productImage: state.cart.items[key].productImage,\r\n\r\n        quantity: state.cart.items[key].quantity,\r\n      })\r\n    }\r\n    return transformedCartItems\r\n  })\r\n  const cartTotalAmount = useSelector((state) => state.cart.totalAmount)\r\n  const isAuth = useSelector((state) => state.user.isAuthenticated)\r\n  const checkoutSuccess = useSelector((state) => state.cart.checkoutSuccess)\r\n  const emailUser = useSelector((state) => state.user)\r\n  const dispatch = useDispatch()\r\n\r\n  const checkout = (method) => {\r\n    if (!isAuth) {\r\n      return createAlert(navigation)\r\n    }\r\n\r\n    if (method === 'contanti') {\r\n      // il cliente vuole pagare con i contanti\r\n      dispatch(cartActions.checkout(cartItems, emailUser, cartTotalAmount))\r\n    }\r\n    setPaymentChoice(false)\r\n  }\r\n\r\n  return (\r\n    <SafeAreaView style={styles.screen}>\r\n      <Header\r\n        backgroundImage={images.otherImages.cartBackgroundHeader}\r\n        backgroundImageStyle={{ borderRadius: 30 }}\r\n        statusBarProps={{ barStyle: 'light-content' }}\r\n        backgroundColor=\"#F6F7FA\"\r\n        rightContainerStyle={{\r\n          alignSelf: 'center',\r\n        }}\r\n        containerStyle={{\r\n          height: 120,\r\n        }}\r\n      />\r\n\r\n      <FlatList\r\n        style={styles.container}\r\n        ListHeaderComponent={\r\n          <Text\r\n            style={{\r\n              fontSize: 23,\r\n              fontFamily: 'Inter_600SemiBold',\r\n              color: '#094067',\r\n              marginBottom: 20,\r\n            }}\r\n          >\r\n            I tuoi ordini\r\n          </Text>\r\n        }\r\n        data={cartItems}\r\n        keyExtractor={(item) => item.productId}\r\n        renderItem={(itemData) => (\r\n          <CartProduct\r\n            image={itemData.item.productImage}\r\n            title={itemData.item.productTitle}\r\n            quantity={itemData.item.quantity}\r\n            product={itemData.item}\r\n          />\r\n        )}\r\n        ListFooterComponent={\r\n          <>\r\n            <View style={styles.priceContainer}>\r\n              {cartTotalAmount === 0 ? (\r\n                <Text\r\n                  style={{\r\n                    fontFamily: 'Inter_400Regular',\r\n                    textAlign: 'center',\r\n                    color: '#5f6c7b',\r\n                  }}\r\n                >\r\n                  Il tuo carrello è vuoto torna ad aggiungere dei prodotti!\r\n                </Text>\r\n              ) : (\r\n                <Text style={styles.summaryText}>\r\n                  Total: <Text style={styles.amount}>€{cartTotalAmount}</Text>\r\n                </Text>\r\n              )}\r\n            </View>\r\n\r\n            {/* button checkout   */}\r\n            <View\r\n              style={{\r\n                marginTop: 30,\r\n                width: '100%',\r\n                overflow: 'hidden',\r\n              }}\r\n            >\r\n              <Button\r\n                onPress={() => setPaymentChoice(true)}\r\n                title=\"acquista!\"\r\n                disabled={cartTotalAmount === 0}\r\n                raised\r\n                icon={<AntDesign name=\"checkcircleo\" size={24} color=\"white\" />}\r\n                iconRight\r\n                titleStyle={{\r\n                  fontFamily: 'Inter_400Regular',\r\n                }}\r\n                containerStyle={{\r\n                  width: '95%',\r\n                  alignSelf: 'center',\r\n                }}\r\n                buttonStyle={{\r\n                  backgroundColor: '#3da9fc',\r\n\r\n                  justifyContent: 'space-between',\r\n\r\n                  padding: 15,\r\n                }}\r\n              />\r\n            </View>\r\n          </>\r\n        }\r\n      />\r\n\r\n      <Overlay\r\n        isVisible={paymentChoice}\r\n        overlayStyle={{\r\n          width: '80%',\r\n        }}\r\n      >\r\n        <Text h4 style={{ textAlign: 'center', marginBottom: 10 }}>\r\n          Scelgi il metodo di pagamento\r\n        </Text>\r\n        <Divider />\r\n        <UserLoggedOption\r\n          customStyle={{\r\n            backgroundColor: '#d8eefe',\r\n            padding: 5,\r\n            marginTop: 30,\r\n            color: '#020826',\r\n          }}\r\n          customHandler={() => checkout('contanti')}\r\n          customColor=\"#094067\"\r\n          title=\"Paga in contanti\"\r\n          icon={\r\n            <MaterialCommunityIcons\r\n              name=\"cash-marker\"\r\n              size={24}\r\n              color=\"#3da9fc\"\r\n            />\r\n          }\r\n        />\r\n        <UserLoggedOption\r\n          customStyle={{ backgroundColor: '#d8eefe', padding: 5 }}\r\n          customHandler={() => checkout('carta')}\r\n          customColor=\"#094067\"\r\n          title=\"Paga con carta\"\r\n          icon={\r\n            <MaterialCommunityIcons\r\n              name=\"credit-card-check-outline\"\r\n              size={24}\r\n              color=\"#3da9fc\"\r\n            />\r\n          }\r\n        />\r\n        <UserLoggedOption\r\n          customStyle={{ backgroundColor: '#d8eefe', padding: 5 }}\r\n          customHandler={() => setPaymentChoice(false)}\r\n          customColor=\"#094067\"\r\n          title=\"Annulla\"\r\n          icon={\r\n            <MaterialCommunityIcons\r\n              name=\"window-close\"\r\n              size={24}\r\n              color=\"#ef4565\"\r\n            />\r\n          }\r\n        />\r\n      </Overlay>\r\n\r\n      <CustomModal\r\n        showModal={checkoutSuccess}\r\n        text=\"Checkout Effettuato\"\r\n        theme=\"rgba(66, 135, 245, 1)\"\r\n      />\r\n      <StatusBar style=\"light\" />\r\n    </SafeAreaView>\r\n  )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  screen: {\r\n    flex: 1,\r\n    backgroundColor: '#F6F7FA',\r\n  },\r\n  container: {\r\n    marginVertical: 20,\r\n    width: '85%',\r\n    alignSelf: 'center',\r\n  },\r\n  product: {\r\n    flexDirection: 'row',\r\n    width: '100%',\r\n\r\n    marginTop: 15,\r\n  },\r\n\r\n  priceContainer: {\r\n    alignItems: 'flex-end',\r\n    marginBottom: 30,\r\n  },\r\n  amount: {\r\n    fontSize: 20,\r\n    fontFamily: 'Inter_600SemiBold',\r\n    color: '#094067',\r\n  },\r\n  summaryText: {\r\n    marginTop: 10,\r\n    marginRight: 10,\r\n  },\r\n  text: {\r\n    textAlign: 'center',\r\n    fontFamily: 'Inter_400Regular',\r\n    marginVertical: 3,\r\n  },\r\n})\r\n\r\nexport default CartScreen\r\n"]},"metadata":{},"sourceType":"module"}